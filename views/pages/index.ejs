<!DOCTYPE html>
<html>

<head>
    <% include ../partials/header %>
</head>

<body>
    <% include ../partials/horizontalMenu %>

    <div class="p-3">

        <div class="p-3 bg-light">
            <div class="container-fluid">

                <form class="form-inline" method="post">
                    <div class="form-group">
                        <input type="text" class="form-control" id="usr" name="usr" placeholder="Usuario">
                    </div>
                    <div class="form-group">
                        <input type="password" class="form-control" id="pwd" name="pwd" placeholder="Contraseña">
                    </div>
                    <button type="submit" class="btn btn-info navbar-btn">Ingresar</button>
                    <button type="button" onclick="olvide()" class="btn btn-info navbar-btn">Olvide mi
                        Contraseña</button>
                    <button type="button" onclick="cambiar()" class="btn btn-info navbar-btn">Cambiar
                        Contraseña</button>
                    <button id="btnSolicitudRegistroAsada" type="button" class="btn btn-info navbar-btn"
                        onclick="location.href='/solicitudRegistroAsada'">Solicitud de registro de ASADA</button>
                    <p style="color: #f00;"><%= error%></p>
                </form>

            <a href="/contacto">Contacto de ASADAs</a>
            <div class="bg-white shadow p-3 mb-5">
                <div class="bg-white shadow p-3 mb-5">
                    <p id="mycomponent">índice de Riesgo Sostenible en el Servicio de Agua y Saneamiento</p>
                <img onclick="location.href='/mapa'" src="/images/IRSSAS-DEF.png" style="width: 100%;">
                </div>
                
                <% include ../partials/informacionProyecto.ejs %>
            </div>
            
        </div>
        

        <% include ../partials/informacionProyecto.ejs %>
  
        </div>
      </div>


            
           


    <!-- jQuery CDN -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
    crossorigin="anonymous"></script>
        src="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.concat.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>

    <script type="text/javascript">
        $(document).ready(function () {
   
            
            $("#menu-toggle").click(function (e) {
                e.preventDefault();
            $("#wrapper").toggleClass("toggled");
        });

            $("#divrisk").click(function () {
                $("#divrisk").toggle("slow", "linear");
                $("#buttonrisk").show();
            });

            $("#buttonrisk").click(function () {
                $("#divrisk").toggle("slow", "linear");
                $("#buttonrisk").hide();
            });

            $("#buttonrisk").hide();

            $("#filts").click(function () {
                $("#menucomps").toggle("slow", "linear");
                $("#menufilts").toggle("slow", "linear");
            });

            $("#filts2").click(function () {
                $("#menucomps").toggle("slow", "linear");
                $("#menufilts").toggle("slow", "linear");
            });

            

            $("#menufilts").hide();


        });
    </script>
    <script>
        function cambiar() {
            Swal.fire({
                title: 'Cambiar contraseña',
                confirmButtonText: 'Cambiar',
                cancelButtonText: 'Cancelar',
                showCancelButton: true,
                cancelButtonColor: '#e13c26',
                confirmButtonColor: '#2d569d',
                html: '<input id="swal-input1" class= "swal2-input" placeholder="Usuario"><br/>' +
                    '<input id = "swal-input2" class= "swal2-input" placeholder="Contraseña actual" type="password"><br/> ' +
                    '<input id = "swal-input3" class= "swal2-input" placeholder="Contraseña nueva" type="password"><br/> ' +
                    '<input id = "swal-input4" class= "swal2-input" placeholder="Confirmar contraseña" type="password"><br/> ',
                focusConfirm: false,
                preConfirm: () => {
                    var clavenueva = $('#swal-input3').val();
                    var claveconfirmacion = $('#swal-input4').val();
                    if ($('#swal-input1').val() && $('#swal-input2').val() && clavenueva && claveconfirmacion) {
                        if (clavenueva != claveconfirmacion)
                            Swal.showValidationMessage('La nueva contraseña debe coincidir')
                    }
                    else {
                        Swal.showValidationMessage('Todos los campos son necesarios')
                    }
                }
            }).then((result) => {
                if (result.value) {
                    var usuario = $('#swal-input1').val();
                    var clave = $('#swal-input2').val();
                    var clavenueva = $('#swal-input3').val();
                    var parameters = { "usuario": usuario, "clave": clave, "clavenueva": clavenueva };
                    $.get('/changePassword', parameters, function (data) {
                    }).done(function (res) {
                        console.log(res);
                        if (res == true)
                            Swal.fire('Proceso exitoso', 'La contraseña ha sido cambiada', 'success');
                        else
                            Swal.fire('Error', res, 'error');
                    });
                }
            })
        }

        function olvide() {
            Swal.fire({
                title: 'Recuperar contraseña',
                confirmButtonText: 'Recuperar',
                cancelButtonText: 'Cancelar',
                showCancelButton: true,
                cancelButtonColor: '#e13c26',
                confirmButtonColor: '#2d569d',
                html: '<input id="swal-input5" class= "swal2-input" placeholder="Correo">',
                focusConfirm: false,
                preConfirm: () => {
                    if (!$('#swal-input5').val())
                        Swal.showValidationMessage('Debe escribir el correo')
                }
            }).then((result) => {
                if (result.value) {
                    var usuario = $('#swal-input5').val();
                    var parameters = { "usuario": usuario };
                    $.get('/forgetPassword', parameters, function (data) {
                    }).done(function (res) {
                        console.log(res);
                        if (res == true)
                            Swal.fire('Proceso exitoso', 'Se enviado al correo la nueva clave', 'success');
                        else
                            Swal.fire('Error', res, 'error');
                    });
                }
            })
        }
    </script>
    <script src="scripts/ol.js"></script>
    <script src="scripts/map.js"></script>
    <script src="scripts/script.js"></script>
</body>

</html>